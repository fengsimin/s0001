<?php
//Copyright (c) 2016 iFeiwu.com
 class Item extends Ifeiwu { public function __construct() { goto ceD1W; ceD1W: if ($this->table) { goto Olizy; } goto MOUbM; qeIbY: Olizy: goto y6g6o; y6g6o: parent::__construct(); goto LOwhe; MOUbM: $this->table = "\x69\x74\145\155"; goto qeIbY; LOwhe: } protected function postPage($request_data) { goto vEW3Z; xZhjO: goto Qlw8W; goto L1E8R; T8MH1: $this->_callback("\143\x61\154\154\142\141\143\153\x50\141\x67\145\x41\x66\x74\145\162", array(&$data)); goto p7R3Y; L1E8R: JYM8z: goto KNlW8; wYmyC: if ($perpage > 0) { goto JYM8z; } goto x30i7; ZWhj3: $order = $request_data["\157\x72\x64\145\x72"] ?: $this->order; goto ez04x; x30i7: $data = $this->db->select($this->table, $column)->where($where)->order($order)->all(); goto xZhjO; p7R3Y: return $this->success($data); goto bC6Sc; YoFRi: $where = $request_data["\x77\x68\x65\162\x65"] ?: "\x31\x20\x3d\x20\61"; goto ZWhj3; vEW3Z: $this->_callback("\x63\x61\x6c\154\142\141\x63\153\x50\x61\x67\x65\102\x65\x66\x6f\x72\x65", array(&$request_data)); goto i5Yim; VNpcz: $data = array("\154\x69\163\x74" => $list, "\x74\157\164\x61\x6c" => $total, "\160\145\x72\160\x61\x67\145" => $perpage, "\160\141\x67\x65" => $page); goto WLXrj; KNlW8: $page = $request_data["\x70\141\x67\145"] ?: 1; goto DxLF5; DxLF5: $page = $page ? $page - 1 : 0; goto vaXvC; WLXrj: Qlw8W: goto T8MH1; DW_Ze: $list = $this->db->select($this->table, $column)->where($where)->order($order)->limit(array($page * $perpage, $perpage))->all(); goto VNpcz; ez04x: $perpage = $request_data["\160\145\162\160\x61\147\145"] ?: 0; goto wYmyC; vaXvC: $total = $this->db->select($this->table)->where($where)->count(); goto DW_Ze; i5Yim: $column = $request_data["\x63\x6f\154\165\x6d\x6e"] ?: "\52"; goto YoFRi; bC6Sc: } protected function postQuery($request_data) { goto SyaM_; Rc2uH: return $this->db->query($sql, $request_data["\166\141\x6c\165\145\163"])->all(); goto nigIs; Gac_6: k6yet: goto Rc2uH; xJdlc: $sql = str_replace("\x24\164\141\x62\154\145", $this->prefix . $this->table, $sql); goto Gac_6; SyaM_: $sql = $request_data["\163\x71\x6c"]; goto pi_lp; pi_lp: if (!(stripos($sql, "\x24\x74\x61\x62\x6c\145") !== false)) { goto k6yet; } goto xJdlc; nigIs: } protected function getOne($id, $column = null) { goto F8nBa; F8nBa: $column = $column ?: "\52"; goto WDgHU; WDgHU: $data = $this->db->select($this->table, $column)->where(array("\x69\144", "\x3d", $id))->get(); goto LKOME; LKOME: return $this->success($data); goto AKTng; AKTng: } protected function postAdd($request_data) { goto KrKs3; VLDf0: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto H7QVX; Q_8n_: $this->_removeFiles2($request_data["\137\x72\145\x6d\157\x76\x65\146\151\x6c\145\163"]); goto zNa8e; OY2g3: $udata = array("\x69\x64" => $id); goto MihDX; LJQre: if ($this->db->update($this->table, $udata, array("\x69\x64", "\75", $id))->is()) { goto H6o_5; } goto SRTwh; KrKs3: $this->_callback("\x63\x61\x6c\x6c\x62\x61\143\153\101\144\x64\x42\145\146\x6f\162\x65", array(&$request_data)); goto Q_8n_; GsTx2: return $this->error("\346\xb7\xbb\345\x8a\xa0\xe6\x95\260\xe6\215\256\xe5\244\261\350\264\245\357\xbc\201"); goto HZBI9; tWv1K: if (!($pid > 0 && in_array("\x6c\x65\166\145\x6c", $this->fields))) { goto qW7fw; } goto MdPPS; MdPPS: $udata["\154\145\x76\x65\154"] = $this->_getLevel($pid, $id); goto fwIdh; HZBI9: goto JZbxM; goto cfI0U; yoix4: $this->db->commit(); goto jnXzp; cfI0U: H6o_5: goto j3DfV; csLvw: return $this->error("\346\xb7\xbb\345\212\xa0\346\225\xb0\346\x8d\256\345\244\261\350\264\245\357\274\201"); goto P7Vcl; j3DfV: $this->_callback("\143\141\x6c\x6c\142\x61\143\153\x41\144\x64\x41\x66\x74\x65\162", array($id, &$request_data)); goto lh3rC; yoVas: if (!($upload_name && $upload_path)) { goto OBjUT; } goto PBj9Y; lh3rC: $this->_log("\141\144\x64", array("\164\x69\164\x6c\145" => $data["\164\151\164\154\145"], "\x74\x61\142\x6c\145\x5f\151\x64" => $id)); goto yoix4; H7QVX: $udata[$upload_name] = $upload_path; goto k66Ta; zNa8e: $data = $this->_bulidData($request_data); goto Z3whr; MihDX: $pid = $data["\x70\151\x64"]; goto tWv1K; VtAPD: if ($id) { goto j99b8; } goto csLvw; fwIdh: qW7fw: goto SRhWd; P7Vcl: j99b8: goto OY2g3; Z3whr: $data["\143\164\151\x6d\145"] = time(); goto zu0m8; SRhWd: $upload_name = $request_data["\x24\x75\160\154\157\x61\144\137\156\141\x6d\x65"]; goto YZPGR; YZPGR: $upload_path = $request_data["\x24\x75\160\x6c\x6f\x61\144\x5f\x70\141\x74\150"]; goto yoVas; PBj9Y: $data["\151\144"] = $id; goto VLDf0; r1F84: $id = $this->db->insert($this->table, $data)->id(); goto VtAPD; kf0Zv: JZbxM: goto oQ25M; k66Ta: OBjUT: goto LJQre; zu0m8: $this->db->beginTransaction(); goto r1F84; jnXzp: return $this->success("\346\xb7\273\345\212\240\346\x95\xb0\xe6\215\256\346\x88\x90\345\x8a\237\357\xbc\201", array("\151\x64" => $id, "\151\155\x61\147\145\x5f\x70\141\164\150" => $upload_path)); goto kf0Zv; SRTwh: $this->db->rollBack(); goto GsTx2; oQ25M: } protected function postUpdate($id, $request_data) { goto XIHZc; s7IUN: return $this->error("\344\277\x9d\xe5\255\230\345\xa4\261\350\264\xa5\357\274\201"); goto PALlg; EEhag: jva2t: goto n7OPk; sco4Y: return $this->success("\345\267\262\xe4\xbf\235\xe5\255\x98\346\233\xb4\346\x94\271\357\xbc\x81"); goto Qdwr_; PSMt3: $this->_removeFiles2($request_data["\137\x72\145\155\x6f\166\145\x66\151\154\145\x73"]); goto LmiOi; PALlg: goto dvCf2; goto EEhag; prdWM: if (!in_array($upload_name, $this->fields)) { goto VBnTe; } goto cYMrV; xgV5g: $data["\x75\x74\x69\x6d\145"] = time(); goto vFgQj; NA31O: $this->_log("\x75\160\x64\x61\x74\x65", array("\164\151\x74\x6c\145" => $data["\x74\x69\164\x6c\x65"])); goto sco4Y; n7OPk: $this->_callback("\143\x61\154\x6c\x62\141\143\x6b\125\160\144\x61\164\x65\101\146\x74\145\162", array($id, &$request_data)); goto NA31O; eTX9u: if (!($upload_name && $upload_path)) { goto QCCgq; } goto aFDah; fUn7J: $upload_path = $request_data["\x24\165\160\154\x6f\141\144\137\160\x61\x74\150"]; goto eTX9u; vFgQj: $pid = $data["\x70\x69\x64"]; goto gvquf; LmiOi: $data = $this->_bulidData($request_data); goto xgV5g; XIHZc: $this->_callback("\143\x61\x6c\x6c\142\x61\x63\153\x55\x70\144\x61\164\145\x42\x65\146\x6f\162\145", array(&$request_data)); goto PSMt3; T0Eb2: VBnTe: goto VRxJA; cYMrV: $data[$upload_name] = $upload_path; goto T0Eb2; C9_ra: if ($this->db->update($this->table, $data, array("\x69\x64", "\x3d", $id))->is()) { goto jva2t; } goto s7IUN; QFz73: BkIq2: goto FBCjo; Qdwr_: dvCf2: goto ZgQek; ukb8P: $data["\154\x65\166\145\x6c"] = $this->_getLevel($pid, $id); goto QFz73; aFDah: $upload_path = $this->_bulidUploadPath($upload_path, $data); goto prdWM; VRxJA: QCCgq: goto C9_ra; FBCjo: $upload_name = $request_data["\44\x75\160\x6c\157\141\x64\x5f\x6e\x61\155\x65"]; goto fUn7J; gvquf: if (!($pid > 0 && in_array("\154\145\166\145\154", $this->fields))) { goto BkIq2; } goto ukb8P; ZgQek: } protected function postField($request_data) { goto FI56S; BVHnx: vJd1K: goto aBdr5; cPSeM: YUoVt: goto Fn2bK; ZQXCb: goto vJd1K; goto cPSeM; WO1SI: $value = $request_data["\166\x61\154\165\145"]; goto F5WQP; aXOun: $name = $request_data["\x6e\141\155\145"]; goto WO1SI; YLtK0: return $this->error(); goto ZQXCb; Fn2bK: return $this->success(); goto BVHnx; FI56S: $ids = $request_data["\151\144"]; goto aXOun; F5WQP: if ($this->db->update($this->table, array($name => $value), array("\x69\x64", "\x49\x4e", $ids))->is()) { goto YUoVt; } goto YLtK0; aBdr5: } protected function postCount($request_data) { goto DCKsG; DCKsG: $table = $request_data["\x74\141\x62\x6c\x65"] ?: $this->table; goto zt6GN; bdbI9: return $this->db->select($table)->where($where)->count(); goto Pvr0w; zt6GN: $where = $request_data["\167\x68\x65\x72\x65"] ?: "\x31\x20\75\x20\x31"; goto bdbI9; Pvr0w: } protected function postDelete($request_data) { goto SkRZi; RfS_R: $this->db->commit(); goto lTUWO; XHI86: foreach ($ids as $id) { goto mibT7; mibT7: $item = $this->db->select($this->table)->where(array("\x69\144", "\75", $id))->get(); goto AzJHH; AzJHH: if ($this->db->delete($this->table, array("\151\144", "\x3d", $id))->is()) { goto CSxAn; } goto XxSAU; r0YeU: goto jUIf3; goto LPiFy; iuAhv: HfRPl: goto gukiP; XxSAU: $error[] = $id; goto r0YeU; gukiP: jUIf3: goto GKsEF; ckkHe: CSxAn: goto qbgrz; LPiFy: goto HfRPl; goto ckkHe; qbgrz: $this->_trash($item, $request_data); goto iuAhv; GKsEF: } goto BiikM; tmLJ2: $this->db->rollBack(); goto JedXY; DkyLH: $this->_callback("\x63\141\x6c\x6c\142\141\143\153\x44\x65\154\145\164\145\x41\x66\164\145\162", array(&$request_data)); goto RfS_R; lTUWO: $this->_log("\162\x65\155\x6f\x76\x65", array("\164\151\x74\x6c\x65" => count($ids))); goto wxql_; wxql_: return $this->success(); goto wuq8R; Ml4Xx: $this->db->beginTransaction(); goto XHI86; u3Dof: if (count($error) === 0) { goto yqhGt; } goto tmLJ2; wuq8R: ETSTd: goto gQFqW; U59yV: goto ETSTd; goto DdW7C; x2vVE: $ids = $request_data["\x69\x64"]; goto Ml4Xx; Ani6d: $error = array(); goto x2vVE; BiikM: RSETx: goto u3Dof; SkRZi: $this->_callback("\143\x61\x6c\154\x62\x61\x63\x6b\104\x65\x6c\x65\x74\x65\x42\145\x66\157\162\x65", array(&$request_data)); goto Ani6d; DdW7C: yqhGt: goto DkyLH; JedXY: return $this->error("\346\234\211\x20" . count($error) . "\xe6\235\241\xe6\x95\xb0\xe6\215\xae\xe5\x88\xa0\351\x99\xa4\345\xa4\xb1\350\264\xa5\xef\274\x81"); goto U59yV; gQFqW: } }
